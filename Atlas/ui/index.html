<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ATLAS | Deep Inspector Panel</title>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300;400;500&family=Inter:wght@300;400;600;800&display=swap"
        rel="stylesheet">
    <!-- Atlas Main Stylesheet -->
    <link rel="stylesheet" href="css/atlas-main.css">
    <!-- Atlas Utility Classes (Phase 2) -->
    <link rel="stylesheet" href="css/atlas-utilities.css">
    <!-- Atlas Component Styles (Phase 3 & 4) -->
    <link rel="stylesheet" href="css/atlas-components.css">
    <!-- Atlas Footer Styles (Phase 6) -->
    <link rel="stylesheet" href="css/atlas-footer.css">
    <!-- Atlas Modal & Dropdown Styles -->
    <link rel="stylesheet" href="css/atlas-modals.css">
    <!-- Atlas Final Overrides -->
    <link rel="stylesheet" href="css/atlas-overrides.css">
    <!-- Font Awesome 6 for professional icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

</head>

<body>


    <!-- ========== PHASE 3: MODERN HEADER ========== -->
    <div class="header">
        <!-- Left: Hamburger + Brand -->
        <div class="header-left">
            <button class="hamburger-btn" onclick="toggleSidebar()" title="Toggle Sidebar">
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
            </button>
            <div class="brand">
                <span class="brand-icon">‚ö°</span>
                <span class="brand-text">ATLAS</span>
                <span class="version-badge">v7.0</span>
            </div>
        </div>

        <!-- Center: Engine Status Card -->
        <div class="header-center">
            <div class="engine-status-card">
                <div class="status-indicator">
                    <div class="status-dot" id="statusDot"></div>
                    <span id="statusLabel">ENGINE STANDBY</span>
                </div>
                <div class="quick-stats">
                    <span class="stat">‚ö° <span id="latencyStat">--</span>ms</span>
                    <span class="stat">üìä <span id="requestStat">--</span></span>
                </div>
            </div>
        </div>


        <!-- Right: User Dropdown (Claude Style) -->
        <div class="header-right">
            <!-- User Dropdown -->
            <div class="header-dropdown">
                <div class="header-dropdown-trigger" onclick="toggleHeaderDropdown()" id="userDropdownTrigger">
                    <span class="icon"><i class="fa-solid fa-user"></i></span>
                    <span id="userDropdownName">User</span>
                    <span style="opacity: 0.5; font-size: 0.7rem;">‚ñº</span>
                </div>

                <div class="header-dropdown-menu" id="headerDropdownMenu">
                    <a href="/arena" class="dropdown-menu-item">
                        <span class="icon"><i class="fa-solid fa-play"></i></span>
                        <span>Arena</span>
                    </a>

                    <div class="dropdown-menu-item" onclick="toggleNotifications(); toggleHeaderDropdown();">
                        <span class="icon"><i class="fa-solid fa-bell"></i></span>
                        <span>Notifications</span>
                        <span class="badge" id="notifCountDropdown"
                            style="display:none; margin-left: auto; background: var(--danger); color: white; padding: 2px 6px; border-radius: 6px; font-size: 0.65rem;">0</span>
                    </div>

                    <div class="dropdown-menu-item" onclick="openAnalytics(); toggleHeaderDropdown();">
                        <span class="icon"><i class="fa-solid fa-chart-simple"></i></span>
                        <span>Analytics</span>
                    </div>

                    <div class="dropdown-menu-item" onclick="alert('Settings coming soon!'); toggleHeaderDropdown();">
                        <span class="icon"><i class="fa-solid fa-gear"></i></span>
                        <span>Settings</span>
                    </div>

                    <div class="dropdown-menu-divider"></div>

                    <div class="dropdown-menu-item danger" onclick="handleLogout(); toggleHeaderDropdown();"
                        id="logoutMenuItem">
                        <span class="icon"><i class="fa-solid fa-right-from-bracket"></i></span>
                        <span>Logout</span>
                    </div>

                    <div class="dropdown-menu-item"
                        onclick="document.getElementById('loginModal').style.display='flex'; toggleHeaderDropdown();"
                        id="loginMenuItem">
                        <span class="icon"><i class="fa-solid fa-right-to-bracket"></i></span>
                        <span>Login</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ========== PHASE 4: MAIN CONTAINER WITH SIDEBAR ========== -->
    <div class="main-container">
        <!-- Left Sidebar -->
        <aside class="sidebar" id="sidebar">
            <!-- Backend Health Monitor -->
            <div class="backend-monitor glass-light p-md rounded-lg mb-md">
                <div class="section-header">
                    <span class="section-title"><i class="fa-solid fa-server"></i> BACKEND HEALTH</span>
                </div>
                <div class="monitor-stats">
                    <div class="monitor-stat">
                        <span class="stat-label">üü¢ Status</span>
                        <span class="stat-value">ONLINE</span>
                    </div>
                    <div class="monitor-stat">
                        <span class="stat-label">‚ö° Latency</span>
                        <span class="stat-value" id="sidebarLatency">--ms</span>
                    </div>
                    <div class="monitor-stat">
                        <span class="stat-label">üìä Requests</span>
                        <span class="stat-value" id="sidebarRequests">--</span>
                    </div>
                </div>
            </div>

            <!-- Session Manager (replacing dropdown) -->
            <div class="session-manager glass-light rounded-lg p-md mb-md">
                <div class="section-header">
                    <span class="section-title"><i class="fa-solid fa-messages"></i> SOHBETLER</span>
                    <button class="btn-new-session" onclick="newChat()">
                        <span class="icon"><i class="fa-solid fa-plus"></i></span> Yeni
                    </button>
                </div>

                <div class="session-list" id="sessionList">
                    <!-- Session cards will be dynamically injected here -->
                </div>

                <button class="btn-clear-all" onclick="clearAllChats()">
                    <i class="fa-solid fa-broom"></i> T√ºm√ºn√º Temizle
                </button>
            </div>

            <!-- Quick Actions -->
            <div class="quick-actions glass-light rounded-lg p-md">
                <div class="section-header">
                    <span class="section-title">‚ö° HIZLI ERƒ∞≈ûƒ∞M</span>
                </div>
                <div class="quick-action-item" onclick="window.location.href='/arena'">
                    <span class="quick-action-icon">üèüÔ∏è</span>
                    <span>Arena</span>
                </div>
                <div class="quick-action-item" onclick="alert('Analytics coming soon!')">
                    <span class="quick-action-icon">üìä</span>
                    <span>Analytics</span>
                </div>
            </div>
        </aside>

        <!-- Chat View (Right Side - Inside main-container) -->
        <div class="chat-view" id="chatView">
            <div class="locked-overlay" id="lockedOverlay">
                <div style="text-align:center;">
                    <div style="font-size: 2rem; margin-bottom: 10px;">üîí</div>
                    SYSTEM LOCKED<br>Geleceƒüi G√∂zlemlemek ƒ∞√ßin Giri≈ü Yapƒ±n
                </div>
            </div>

            <div class="message-wrapper ai">
                <div class="bubble">
                    <h3>Sisteme Ho≈ü Geldin, Observer.</h3>
                    <p>ATLAS motoru t√ºm katmanlarƒ±yla aktif. Analiz raporlarƒ±nƒ± g√∂rmek i√ßin mesajlarƒ±n altƒ±ndaki
                        <strong>[RDR]</strong> butonlarƒ±nƒ± kullanabilirsin.
                    </p>
                </div>
            </div>
        </div>
    </div>
    <!-- End of main-container -->

    <!-- Modern Login Modal (Forced, Unclosable) -->
    <div class="login-modal" id="loginModal">
        <div class="login-card">
            <h2><i class="fa-solid fa-lock"></i> ATLAS Giri≈ü</h2>
            <p>Sisteme eri≈üim i√ßin kimlik doƒürulama gereklidir</p>
            <input type="text" id="loginUser" class="login-input" placeholder="Kullanƒ±cƒ± Adƒ±" autocomplete="username">
            <input type="password" id="loginPass" class="login-input" placeholder="≈ûifre"
                autocomplete="current-password">
            <button class="login-submit" onclick="handleLogin()">Giri≈ü Yap</button>
            <div id="loginError"></div>
        </div>
    </div>

    <div class="notif-panel" id="notifPanel">
        <div class="notif-header">
            PROAKTƒ∞F UYARILAR
            <div id="notifList">
                <p style="padding: 20px; color: var(--text-dim); font-size: 0.8rem; text-align:center;">Yeni bildirim
                    bulunmuyor.</p>
            </div>
        </div>
    </div>

    <!-- Analytics Modal -->
    <div class="analytics-modal" id="analyticsModal">
        <div class="analytics-content">
            <div class="analytics-header">
                <h2><i class="fa-solid fa-chart-line"></i> Analytics & Usage</h2>
                <button class="analytics-close" onclick="closeAnalytics()">√ó</button>
            </div>

            <div class="analytics-section">
                <h3><i class="fa-solid fa-key"></i> API Keys</h3>
                <div class="analytics-grid">
                    <div class="analytics-card">
                        <div class="analytics-card-label">Groq API</div>
                        <div class="analytics-card-value" id="groqStatus">Active</div>
                    </div>
                    <div class="analytics-card">
                        <div class="analytics-card-label">Google API</div>
                        <div class="analytics-card-value" id="googleStatus">Active</div>
                    </div>
                </div>
            </div>

            <div class="analytics-section">
                <h3><i class="fa-solid fa-chart-line"></i> Model Usage Limits</h3>
                <div class="analytics-grid">
                    <div class="analytics-card">
                        <div class="analytics-card-label">Groq Requests</div>
                        <div class="analytics-card-value" id="groqRequests">-- / 14,400</div>
                        <div class="analytics-card-bar">
                            <div class="analytics-card-bar-fill" id="groqBar" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="analytics-card">
                        <div class="analytics-card-label">Google Requests</div>
                        <div class="analytics-card-value" id="googleRequests">-- / 1,500</div>
                        <div class="analytics-card-bar">
                            <div class="analytics-card-bar-fill" id="googleBar" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="analytics-section">
                <h3>‚ö° Performance</h3>
                <div class="analytics-grid">
                    <div class="analytics-card">
                        <div class="analytics-card-label">Avg Latency</div>
                        <div class="analytics-card-value" id="avgLatency">-- ms</div>
                    </div>
                    <div class="analytics-card">
                        <div class="analytics-card-label">Total Requests</div>
                        <div class="analytics-card-value" id="totalRequests">--</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ========== PHASE 6: MODERN FOOTER ========== -->
    <div class="footer">

        <!-- Enhanced Input Wrapper -->
        <div class="input-wrapper glass-strong">
            <!-- Persona Selector - Input i√ßinde -->
            <div class="persona-input-selector">
                <button class="persona-input-btn" onclick="togglePersonaInput()" id="personaInputBtn"
                    aria-label="Persona se√ßici" aria-haspopup="listbox" aria-expanded="false">
                    <span class="persona-icon" id="currentPersonaIcon">‚ö°</span>
                    <span class="persona-name-short" id="currentPersonaShort">Std</span>
                    <span class="dropdown-arrow">‚ñº</span>
                </button>

                <div class="persona-input-dropdown" id="personaInputDropdown" role="listbox"
                    aria-label="Persona se√ßenekleri">
                    <div class="persona-dropdown-item" data-persona="standard" onclick="selectPersona('standard')"
                        role="option" tabindex="-1">
                        <span class="persona-icon">‚ö°</span>
                        <div>
                            <div class="persona-name">Standart</div>
                            <div class="persona-desc">Dengeli ve profesyonel yakla≈üƒ±m</div>
                        </div>
                    </div>
                    <div class="persona-dropdown-item" data-persona="professional"
                        onclick="selectPersona('professional')" role="option" tabindex="-1">
                        <span class="persona-icon">üíº</span>
                        <div>
                            <div class="persona-name">Kurumsal</div>
                            <div class="persona-desc">Formal ve ciddi ton</div>
                        </div>
                    </div>
                    <div class="persona-dropdown-item" data-persona="kanka" onclick="selectPersona('kanka')"
                        role="option" tabindex="-1">
                        <span class="persona-icon">ü§ù</span>
                        <div>
                            <div class="persona-name">Kanka</div>
                            <div class="persona-desc">Samimi ve rahat sohbet</div>
                        </div>
                    </div>
                    <div class="persona-dropdown-item" data-persona="creative" onclick="selectPersona('creative')"
                        role="option" tabindex="-1">
                        <span class="persona-icon">üé®</span>
                        <div>
                            <div class="persona-name">Sanat√ßƒ±</div>
                            <div class="persona-desc">Yaratƒ±cƒ± ve ilham verici</div>
                        </div>
                    </div>
                    <div class="persona-dropdown-item" data-persona="concise" onclick="selectPersona('concise')"
                        role="option" tabindex="-1">
                        <span class="persona-icon">üéØ</span>
                        <div>
                            <div class="persona-name">Net & √ñz</div>
                            <div class="persona-desc">Kƒ±sa ve net cevaplar</div>
                        </div>
                    </div>
                    <div class="persona-dropdown-item" data-persona="sincere" onclick="selectPersona('sincere')"
                        role="option" tabindex="-1">
                        <span class="persona-icon">üíô</span>
                        <div>
                            <div class="persona-name">ƒ∞√ßten Dost</div>
                            <div class="persona-desc">Samimi ve anlayƒ±≈ülƒ±</div>
                        </div>
                    </div>
                    <div class="persona-dropdown-item" data-persona="detailed" onclick="selectPersona('detailed')"
                        role="option" tabindex="-1">
                        <span class="persona-icon">üìö</span>
                        <div>
                            <div class="persona-name">Eƒüitmen</div>
                            <div class="persona-desc">Detaylƒ± ve √∂ƒüretici</div>
                        </div>
                    </div>
                    <div class="persona-dropdown-item" data-persona="girlfriend" onclick="selectPersona('girlfriend')"
                        role="option" tabindex="-1">
                        <span class="persona-icon">üíï</span>
                        <div>
                            <div class="persona-name">Sevgili</div>
                            <div class="persona-desc">Sevgi dolu ve ≈üefkatli</div>
                        </div>
                    </div>
                    <div class="persona-dropdown-item" data-persona="friendly" onclick="selectPersona('friendly')"
                        role="option" tabindex="-1">
                        <span class="persona-icon">üòä</span>
                        <div>
                            <div class="persona-name">Yardƒ±msever</div>
                            <div class="persona-desc">Dostane ve yardƒ±msever</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Hidden file input -->
            <input type="file" id="fileInput" multiple accept="image/jpeg,image/png,image/webp,image/gif"
                style="display: none;">

            <!-- Action Buttons -->
            <button class="action-btn" id="uploadBtn" onclick="document.getElementById('fileInput').click()"
                title="Dosya Y√ºkle">
                <span class="icon"><i class="fa-solid fa-paperclip"></i></span>
            </button>

            <!-- Main Input Field -->
            <input type="text" id="userInput" class="main-input" placeholder="Mesajƒ±nƒ±zƒ± yazƒ±n..." autocomplete="off">

            <!-- Send Button -->
            <button class="action-btn send-btn" id="sendBtn" onclick="handleSend()" title="G√∂nder">
                <span class="icon"><i class="fa-solid fa-arrow-right"></i></span>
            </button>
        </div>

        <!-- Hidden Legacy Select for Compatibility -->
        <select id="personaSelect" style="display: none;">
            <option value="standard">Standart</option>
            <option value="professional">Kurumsal / Ciddi</option>
            <option value="sincere">ƒ∞√ßten Dost</option>
            <option value="kanka">Kanka</option>
            <option value="creative">Sanat√ßƒ± / ≈ûair</option>
            <option value="concise">Net & √ñz (Uzman)</option>
            <option value="detailed">Eƒüitmen / √ñƒüretmen</option>
            <option value="girlfriend">Sevgili</option>
            <option value="friendly">Yardƒ±msever</option>
        </select>
    </div>

    <!-- Atlas Main Script -->
    <script src="js/atlas-main.js"></script>
</body>

</html>