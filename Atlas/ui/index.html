<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ATLAS | Deep Inspector Panel</title>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300;400;500&family=Inter:wght@300;400;600;800&display=swap"
        rel="stylesheet">
    <!-- Atlas Main Stylesheet -->
    <link rel="stylesheet" href="css/atlas-main.css">
    <!-- Atlas Utility Classes (Phase 2) -->
    <link rel="stylesheet" href="css/atlas-utilities.css">
    <!-- Atlas Component Styles (Phase 3 & 4) -->
    <link rel="stylesheet" href="css/atlas-components.css">
    <!-- Atlas Footer Styles (Phase 6) -->
    <link rel="stylesheet" href="css/atlas-footer.css">
    <!-- Atlas Modal & Dropdown Styles -->
    <link rel="stylesheet" href="css/atlas-modals.css">
    <!-- Atlas Final Overrides -->
    <link rel="stylesheet" href="css/atlas-overrides.css">

</head>

<body>


    <!-- ========== PHASE 3: MODERN HEADER ========== -->
    <div class="header">
        <!-- Left: Hamburger + Brand -->
        <div class="header-left">
            <button class="hamburger-btn" onclick="toggleSidebar()" title="Toggle Sidebar">
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
            </button>
            <div class="brand">
                <span class="brand-icon">âš¡</span>
                <span class="brand-text">ATLAS</span>
                <span class="version-badge">v7.0</span>
            </div>
        </div>

        <!-- Center: Engine Status Card -->
        <div class="header-center">
            <div class="engine-status-card">
                <div class="status-indicator">
                    <div class="status-dot" id="statusDot"></div>
                    <span id="statusLabel">ENGINE STANDBY</span>
                </div>
                <div class="quick-stats">
                    <span class="stat">âš¡ <span id="latencyStat">--</span>ms</span>
                    <span class="stat">ğŸ“Š <span id="requestStat">--</span></span>
                </div>
            </div>
        </div>


        <!-- Right: User Dropdown (Claude Style) -->
        <div class="header-right">
            <!-- User Dropdown -->
            <div class="header-dropdown">
                <div class="header-dropdown-trigger" onclick="toggleHeaderDropdown()" id="userDropdownTrigger">
                    <span class="icon" style="opacity: 0.8;">ğŸ‘¤</span>
                    <span id="userDropdownName">User</span>
                    <span style="opacity: 0.5; font-size: 0.7rem;">â–¼</span>
                </div>

                <div class="header-dropdown-menu" id="headerDropdownMenu">
                    <a href="/arena" class="dropdown-menu-item">
                        <span class="icon" style="opacity: 0.7;">ğŸŸï¸</span>
                        <span>Arena</span>
                    </a>

                    <div class="dropdown-menu-item" onclick="toggleNotifications(); toggleHeaderDropdown();">
                        <span class="icon" style="opacity: 0.7;">ğŸ””</span>
                        <span>Notifications</span>
                        <span class="badge" id="notifCountDropdown"
                            style="display:none; margin-left: auto; background: var(--danger); color: white; padding: 2px 6px; border-radius: 6px; font-size: 0.65rem;">0</span>
                    </div>

                    <div class="dropdown-menu-item" onclick="openAnalytics(); toggleHeaderDropdown();">
                        <span class="icon" style="opacity: 0.7;">ğŸ“Š</span>
                        <span>Analytics</span>
                    </div>

                    <div class="dropdown-menu-item" onclick="alert('Settings coming soon!'); toggleHeaderDropdown();">
                        <span class="icon" style="opacity: 0.7;">âš™ï¸</span>
                        <span>Settings</span>
                    </div>

                    <div class="dropdown-menu-divider"></div>

                    <div class="dropdown-menu-item danger" onclick="handleLogout(); toggleHeaderDropdown();"
                        id="logoutMenuItem">
                        <span class="icon" style="opacity: 0.7;">ğŸšª</span>
                        <span>Logout</span>
                    </div>

                    <div class="dropdown-menu-item"
                        onclick="document.getElementById('loginModal').style.display='flex'; toggleHeaderDropdown();"
                        id="loginMenuItem">
                        <span class="icon" style="opacity: 0.7;">ğŸ”‘</span>
                        <span>Login</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ========== PHASE 4: MAIN CONTAINER WITH SIDEBAR ========== -->
    <div class="main-container">
        <!-- Left Sidebar -->
        <aside class="sidebar" id="sidebar">
            <!-- Backend Health Monitor -->
            <div class="backend-monitor glass-light p-md rounded-lg mb-md">
                <div class="section-header">
                    <span class="section-title">ğŸ–¥ï¸ BACKEND HEALTH</span>
                </div>
                <div class="monitor-stats">
                    <div class="monitor-stat">
                        <span class="stat-label">ğŸŸ¢ Status</span>
                        <span class="stat-value">ONLINE</span>
                    </div>
                    <div class="monitor-stat">
                        <span class="stat-label">âš¡ Latency</span>
                        <span class="stat-value" id="sidebarLatency">--ms</span>
                    </div>
                    <div class="monitor-stat">
                        <span class="stat-label">ğŸ“Š Requests</span>
                        <span class="stat-value" id="sidebarRequests">--</span>
                    </div>
                </div>
            </div>

            <!-- Session Manager (replacing dropdown) -->
            <div class="session-manager glass-light rounded-lg p-md mb-md">
                <div class="section-header">
                    <span class="section-title">ğŸ’¬ SOHBETLER</span>
                    <button class="btn-new-session" onclick="newChat()">
                        <span class="icon">+</span> Yeni
                    </button>
                </div>

                <div class="session-list" id="sessionList">
                    <!-- Session cards will be dynamically injected here -->
                </div>

                <button class="btn-clear-all" onclick="clearAllChats()">
                    ğŸ§¹ TÃ¼mÃ¼nÃ¼ Temizle
                </button>
            </div>

            <!-- Quick Actions -->
            <div class="quick-actions glass-light rounded-lg p-md">
                <div class="section-header">
                    <span class="section-title">âš¡ HIZLI ERÄ°ÅÄ°M</span>
                </div>
                <div class="quick-action-item" onclick="window.location.href='/arena'">
                    <span class="quick-action-icon">ğŸŸï¸</span>
                    <span>Arena</span>
                </div>
                <div class="quick-action-item" onclick="alert('Analytics coming soon!')">
                    <span class="quick-action-icon">ğŸ“Š</span>
                    <span>Analytics</span>
                </div>
            </div>
        </aside>

        <!-- Chat View (Right Side - Inside main-container) -->
        <div class="chat-view" id="chatView">
            <div class="locked-overlay" id="lockedOverlay">
                <div style="text-align:center;">
                    <div style="font-size: 2rem; margin-bottom: 10px;">ğŸ”’</div>
                    SYSTEM LOCKED<br>GeleceÄŸi GÃ¶zlemlemek Ä°Ã§in GiriÅŸ YapÄ±n
                </div>
            </div>

            <div class="message-wrapper ai">
                <div class="bubble">
                    <h3>Sisteme HoÅŸ Geldin, Observer.</h3>
                    <p>ATLAS motoru tÃ¼m katmanlarÄ±yla aktif. Analiz raporlarÄ±nÄ± gÃ¶rmek iÃ§in mesajlarÄ±n altÄ±ndaki
                        <strong>[RDR]</strong> butonlarÄ±nÄ± kullanabilirsin.
                    </p>
                </div>
            </div>
        </div>
    </div>
    <!-- End of main-container -->

    <!-- Modern Login Modal (Forced, Unclosable) -->
    <div class="login-modal" id="loginModal">
        <div class="login-card">
            <h2>ğŸ” ATLAS GiriÅŸ</h2>
            <p>Sisteme eriÅŸim iÃ§in kimlik doÄŸrulama gereklidir</p>
            <input type="text" id="loginUser" class="login-input" placeholder="KullanÄ±cÄ± AdÄ±" autocomplete="username">
            <input type="password" id="loginPass" class="login-input" placeholder="Åifre"
                autocomplete="current-password">
            <button class="login-submit" onclick="handleLogin()">GiriÅŸ Yap</button>
            <div id="loginError"></div>
        </div>
    </div>

    <div class="notif-panel" id="notifPanel">
        <div class="notif-header">
            PROAKTÄ°F UYARILAR
            <div id="notifList">
                <p style="padding: 20px; color: var(--text-dim); font-size: 0.8rem; text-align:center;">Yeni bildirim
                    bulunmuyor.</p>
            </div>
        </div>
    </div>

    <!-- Analytics Modal -->
    <div class="analytics-modal" id="analyticsModal">
        <div class="analytics-content">
            <div class="analytics-header">
                <h2>ğŸ“Š Analytics & Usage</h2>
                <button class="analytics-close" onclick="closeAnalytics()">Ã—</button>
            </div>

            <div class="analytics-section">
                <h3>ğŸ”‘ API Keys</h3>
                <div class="analytics-grid">
                    <div class="analytics-card">
                        <div class="analytics-card-label">Groq API</div>
                        <div class="analytics-card-value" id="groqStatus">Active</div>
                    </div>
                    <div class="analytics-card">
                        <div class="analytics-card-label">Google API</div>
                        <div class="analytics-card-value" id="googleStatus">Active</div>
                    </div>
                </div>
            </div>

            <div class="analytics-section">
                <h3>ğŸ“ˆ Model Usage Limits</h3>
                <div class="analytics-grid">
                    <div class="analytics-card">
                        <div class="analytics-card-label">Groq Requests</div>
                        <div class="analytics-card-value" id="groqRequests">-- / 14,400</div>
                        <div class="analytics-card-bar">
                            <div class="analytics-card-bar-fill" id="groqBar" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="analytics-card">
                        <div class="analytics-card-label">Google Requests</div>
                        <div class="analytics-card-value" id="googleRequests">-- / 1,500</div>
                        <div class="analytics-card-bar">
                            <div class="analytics-card-bar-fill" id="googleBar" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="analytics-section">
                <h3>âš¡ Performance</h3>
                <div class="analytics-grid">
                    <div class="analytics-card">
                        <div class="analytics-card-label">Avg Latency</div>
                        <div class="analytics-card-value" id="avgLatency">-- ms</div>
                    </div>
                    <div class="analytics-card">
                        <div class="analytics-card-label">Total Requests</div>
                        <div class="analytics-card-value" id="totalRequests">--</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ========== PHASE 6: MODERN FOOTER ========== -->
    <div class="footer">

        <!-- Enhanced Input Wrapper -->
        <div class="input-wrapper glass-strong">
            <!-- Persona Selector - Input iÃ§inde -->
            <div class="persona-input-selector">
                <button class="persona-input-btn" onclick="togglePersonaInput()" id="personaInputBtn"
                    aria-label="Persona seÃ§ici" aria-haspopup="listbox" aria-expanded="false">
                    <span class="persona-icon" id="currentPersonaIcon">âš¡</span>
                    <span class="persona-name-short" id="currentPersonaShort">Std</span>
                    <span class="dropdown-arrow">â–¼</span>
                </button>

                <div class="persona-input-dropdown" id="personaInputDropdown" role="listbox"
                    aria-label="Persona seÃ§enekleri">
                    <div class="persona-dropdown-item" data-persona="standard" onclick="selectPersona('standard')"
                        role="option" tabindex="-1">
                        <span class="persona-icon">âš¡</span>
                        <div>
                            <div class="persona-name">Standart</div>
                            <div class="persona-desc">Dengeli ve profesyonel yaklaÅŸÄ±m</div>
                        </div>
                    </div>
                    <div class="persona-dropdown-item" data-persona="professional"
                        onclick="selectPersona('professional')" role="option" tabindex="-1">
                        <span class="persona-icon">ğŸ’¼</span>
                        <div>
                            <div class="persona-name">Kurumsal</div>
                            <div class="persona-desc">Formal ve ciddi ton</div>
                        </div>
                    </div>
                    <div class="persona-dropdown-item" data-persona="kanka" onclick="selectPersona('kanka')"
                        role="option" tabindex="-1">
                        <span class="persona-icon">ğŸ¤</span>
                        <div>
                            <div class="persona-name">Kanka</div>
                            <div class="persona-desc">Samimi ve rahat sohbet</div>
                        </div>
                    </div>
                    <div class="persona-dropdown-item" data-persona="creative" onclick="selectPersona('creative')"
                        role="option" tabindex="-1">
                        <span class="persona-icon">ğŸ¨</span>
                        <div>
                            <div class="persona-name">SanatÃ§Ä±</div>
                            <div class="persona-desc">YaratÄ±cÄ± ve ilham verici</div>
                        </div>
                    </div>
                    <div class="persona-dropdown-item" data-persona="concise" onclick="selectPersona('concise')"
                        role="option" tabindex="-1">
                        <span class="persona-icon">ğŸ¯</span>
                        <div>
                            <div class="persona-name">Net & Ã–z</div>
                            <div class="persona-desc">KÄ±sa ve net cevaplar</div>
                        </div>
                    </div>
                    <div class="persona-dropdown-item" data-persona="sincere" onclick="selectPersona('sincere')"
                        role="option" tabindex="-1">
                        <span class="persona-icon">ğŸ’™</span>
                        <div>
                            <div class="persona-name">Ä°Ã§ten Dost</div>
                            <div class="persona-desc">Samimi ve anlayÄ±ÅŸlÄ±</div>
                        </div>
                    </div>
                    <div class="persona-dropdown-item" data-persona="detailed" onclick="selectPersona('detailed')"
                        role="option" tabindex="-1">
                        <span class="persona-icon">ğŸ“š</span>
                        <div>
                            <div class="persona-name">EÄŸitmen</div>
                            <div class="persona-desc">DetaylÄ± ve Ã¶ÄŸretici</div>
                        </div>
                    </div>
                    <div class="persona-dropdown-item" data-persona="girlfriend" onclick="selectPersona('girlfriend')"
                        role="option" tabindex="-1">
                        <span class="persona-icon">ğŸ’•</span>
                        <div>
                            <div class="persona-name">Sevgili</div>
                            <div class="persona-desc">Sevgi dolu ve ÅŸefkatli</div>
                        </div>
                    </div>
                    <div class="persona-dropdown-item" data-persona="friendly" onclick="selectPersona('friendly')"
                        role="option" tabindex="-1">
                        <span class="persona-icon">ğŸ˜Š</span>
                        <div>
                            <div class="persona-name">YardÄ±msever</div>
                            <div class="persona-desc">Dostane ve yardÄ±msever</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Hidden file input -->
            <input type="file" id="fileInput" multiple accept="image/jpeg,image/png,image/webp,image/gif"
                style="display: none;">

            <!-- File Upload Button -->
            <button class="input-action-btn" onclick="document.getElementById('fileInput').click()"
                title="Upload Image">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path
                        d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48">
                    </path>
                </svg>
            </button>

            <!-- Main Text Input -->
            <input type="text" id="userInput" class="main-input" placeholder="Sisteme bir komut ver..."
                autocomplete="off">

            <!-- Send Button -->
            <button class="send-btn-enhanced" id="sendBtn" onclick="handleSend()" title="Send Message">
                <svg class="send-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2">
                    <line x1="22" y1="2" x2="11" y2="13"></line>
                    <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                </svg>
                <span class="send-text">GÃ¶nder</span>
            </button>
        </div>

        <!-- Hidden Legacy Select for Compatibility -->
        <select id="personaSelect" style="display: none;">
            <option value="standard">Standart</option>
            <option value="professional">Kurumsal / Ciddi</option>
            <option value="sincere">Ä°Ã§ten Dost</option>
            <option value="kanka">Kanka</option>
            <option value="creative">SanatÃ§Ä± / Åair</option>
            <option value="concise">Net & Ã–z (Uzman)</option>
            <option value="detailed">EÄŸitmen / Ã–ÄŸretmen</option>
            <option value="girlfriend">Sevgili</option>
            <option value="friendly">YardÄ±msever</option>
        </select>
    </div>

    <!-- Atlas Main Script -->
    <script src="js/atlas-main.js"></script>
</body>

</html>